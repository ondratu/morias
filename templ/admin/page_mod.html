{% if site.this == '/admin/page/add' -%}
    {% set title = 'Admin - edit page ' + page.name -%}
{% else -%}
    {% set title = 'Admin - new page' -%}
{% endif -%}
{% include "_header.html" -%}
{% include "admin/_menu.html" %}

    <script src="/js/rights.js"></script>
    <script src="/js/hiddener.js"></script>

    <div class="container">
    {% if site.this == '/admin/page/add' -%}
      <h2 class="form-signin-heading">{{ _('New page') }}
    {% else -%}
      <h2 class="form-signin-heading">{{ _('Edit page') }} <small class="monospace">{{ page.name }}</small>
      {% if check_right('page_create') -%}
        <span class="btn btn-default pull-right"><a href="/admin/page/add">{{ _('New page') }}</a></span>
      {% endif -%}
    {% endif -%}
      {% if check_right('page_list') -%}
        <span class="btn btn-default pull-right"><a href="/admin/page">{{ _('Page list') }}</a></span>
      {% endif -%}
      </h2>
      <form class="form-horizontal" role="form" method="post">
       <div id="page_panel">
        <div class="form-group">
          <label for="input_filename" class="col-sm-1 control-label">{{ _('File name') }}</label>
          <div class="col-sm-4 {{ 'has-error' if error is defined else '' }}">
            <input type="text" id="input_filename" name="name" class="form-control" placeholder="{{ _('File name on server') }}" value="{{ page.name or '' }}">
            <div class="help-inline" >{% include "admin/_page_error.html" %}</div>
          </div>

          <label for="input_locale" class="col-sm-1 control-label">{{ _('Locale') }}</label>
          <div class="col-sm-3">
            <input type="text" id="input_locale" name="locale" class="form-control" placeholder="{{ _('Locale') }}" value="{{ page.locale or '' }}">
          </div>
        </div>

        <div class="form-group">
            <label class="col-sm-1 control-label">{{ _('Rights') }}</label>
            <label style="text-align: center;" class="col-sm-5 control-label">{{ _('Possilbe rights') }}</label>
            <label style="text-align: center;" class="col-sm-5 control-label">{{ _('Attache rights') }}</label>
        </div>
        <div class="form-group">
          <div id="possible_rights" class="col-sm-5 col-sm-offset-1">
          {% for right in rights if right not in page.rights -%}
            <a class="col-sm-5 btn btn-default btn-add" value="{{ right }}">
              <span class="pull-left">{{ right }}</span>
              <span class="pull-right glyphicon"></span></a>
            <div class="col-sm-1"></div>
          {% endfor %}
          </div>
          <div id="attache_rights" class="col-sm-5">    
          {% for right in page.rights -%}
            <a class="col-sm-5 btn btn-default btn-remove" value="{{ right }}">
              <span class="pull-left">{{ right }}</span>
              <span class="pull-right glyphicon"></span></a>
            <div class="col-sm-1"></div>
            <input type="hidden" value="{{right}}" name="rights">
          {% endfor %}
          </div>
        </div>
       </div><!-- hiddener -->

        <div class="form-group">
          <label for="input_title" class="col-sm-1 control-label">{{ _('Title') }}</label>
          <div class="col-sm-8">
            <input type="text" id="input_title" name="title" class="form-control" placeholder="{{ _('Title') }}" value="{{ page.title or '' }}">
          </div>

          <div class="col-sm-1"><a class="swittcher pull-right" elm="page_panel"><span class="glyphicon glyphicon-chevron-up"></span></a></div>
          <div class="col-sm-2"><button class="btn btn-default btn-block pull-right" type="submit">{{ _('Save') }}</button></div>
        </div>

        <div class="form-group">
          <div class="col-sm-12">
            <textarea id="input_text" name="text" class="form-control" rows="18">{{ page.text or '' }}</textarea></div>
        </div>
        <div class="form-group">
          <div class="col-sm-12">
            <button class="col-sm-2 btn btn-default pull-right" type="submit">{{ _('Save') }}</button></div></div>
      </form>
    </div>
  {% if site.this == '/admin/page/mod' -%}
    <script>
        var btn = $('.swittcher');
        M.hiddener.close(btn, 0); 
    </script>
  {% endif -%}

{% include "_footer.html" %}
